[["index.html", "Learning R 简介", " Learning R 巩超 2024年11月22日 简介 最近在使用R软件的过程中遇到很多问题，通过Google找到很多博主提供的解决方案，但是浏览器的收藏夹已经多到不行，打算整理一下近期学到的内容，集合到本书中方便查阅，也对过去学到的东西进行整合和思考。 本书利用R的bookdown软件包及李东风老师的模板制作，采用该形式是因为之前通过blogdown软件包搭建了个人博客，打算将博客和在线书籍两部分整合到一处，当然也是因为这一套工作流程非常舒适，Bookdown的详细用法参见https://bookdown.org/yihui/bookdown/，在李东风老师的《R语言教程》也有部分介绍。 "],["plot.html", "1 R绘图 1.1 斜率图与newggslopegraph 1.2 ggplot坐标轴刻度放缩 1.3 地理空间包的退役", " 1 R绘图 1.1 斜率图与newggslopegraph 最近在制作分疾病别的患病率历年变化趋势时，看到有的研究采用多列排序图来展示，每列代表某年的疾病患病率排序，但不同列进行比较的时候只能看出排序变化而很难直观看出率的变化。 经过检索后发现斜率图可以满足前述需求，而newggslopegraph可以实现该需求，故记录该网页给出的代码，方便之后使用。 library(CGPfunctions) df &lt;- newgdp[16:30, ] newggslopegraph(df, Year, GDP, Country, Title = &quot;GDP evolution&quot;, SubTitle = &quot;1970-1979&quot;, Caption = &quot;By R CHARTS&quot;, XTextSize = 18, # Size of the times YTextSize = 2, # Size of the groups TitleTextSize = 14, SubTitleTextSize = 12, CaptionTextSize = 10, TitleJustify = &quot;right&quot;, SubTitleJustify = &quot;right&quot;, CaptionJustify = &quot;left&quot;, DataTextSize = 2.5, # Size of the data ReverseYAxis = TRUE, ReverseXAxis = FALSE) # reverse axes 1.2 ggplot坐标轴刻度放缩 最近在用ggplot绘图，遇到了一个需求，就是对坐标轴进行放缩并不均等地展示刻度。 经过检索后发现简书有位大佬王诗翔科普了相关函数，可以实现该目的，故将该网页介绍的函数和给出的代码部分记录在此。 首先展示原图，很常规的散点图。 # Convert dose column dose from a numeric to a factor variable ToothGrowth$dose &lt;- as.factor(ToothGrowth$dose) library(ggplot2) # scatter plot sp&lt;-ggplot(cars, aes(x = speed, y = dist)) + geom_point() sp 想要改变连续轴的范围，可以使用xlim()和ylim()函数，min和max是每个轴的最小值和最大值。 # scatter plots : change x and y limits sp + xlim(0, 40)+ylim(0, 150) 注意，函数 expand_limits() 可以用于：快速设置在x和y轴在 (0,0) 处的截距项，改变x和y轴范围。 # set the intercept of x and y axis at (0,0) sp + expand_limits(x=0, y=0) # change the axis limits sp + expand_limits(x=c(0,30), y=c(0, 150)) 也可以使用函数scale_x_continuous()和scale_y_continuous()分别改变x和y轴的刻度范围（该函数还可以通过trans参数控制轴转换实现对数化）。 # Change x and y axis labels, and limits sp + scale_x_continuous(name=&quot;Speed of cars&quot;, limits=c(0, 30)) + scale_y_continuous(name=&quot;Stopping distance&quot;, limits=c(0, 150)) 其他实现轴转换（如对数化和开方）的内置转换函数： scale_x_log10(), scale_y_log10() : for log10 transformation scale_x_sqrt(), scale_y_sqrt() : for sqrt transformation scale_x_reverse(), scale_y_reverse() : to reverse coordinates coord_trans(x =“log10”, y=“log10”) : possible values for x and y are “log2”, “log10”, “sqrt”, … scale_x_continuous(trans=‘log2’), scale_y_continuous(trans=‘log2’) : another allowed value for the argument trans is ‘log10’ 使用示例： # Log transformation using scale_xx() # possible values for trans : &#39;log2&#39;, &#39;log10&#39;,&#39;sqrt&#39; sp + scale_x_continuous(trans=&#39;log2&#39;) + scale_y_continuous(trans=&#39;log2&#39;) # Sqrt transformation sp + scale_y_sqrt() # Reverse coordinates sp + scale_y_reverse() # Possible values for x and y : &quot;log2&quot;, &quot;log10&quot;, &quot;sqrt&quot;, ... sp + coord_trans(x=&quot;log2&quot;, y=&quot;log2&quot;) 格式化刻度标签，需要加载scales包： # Log2 scaling of the y axis (with visually-equal spacing) library(scales) ## ## Attaching package: &#39;scales&#39; ## The following object is masked from &#39;package:purrr&#39;: ## ## discard ## The following object is masked from &#39;package:readr&#39;: ## ## col_factor sp + scale_y_continuous(trans = log2_trans()) # show exponents sp + scale_y_continuous(trans = log2_trans(), breaks = trans_breaks(&quot;log2&quot;, function(x) 2^x), labels = trans_format(&quot;log2&quot;, math_format(2^.x))) # Percent sp + scale_y_continuous(labels = percent) # dollar sp + scale_y_continuous(labels = dollar) # scientific sp + scale_y_continuous(labels = scientific) scales包也可以实现对数化刻度标记： library(MASS) # to access Animals data sets ## ## Attaching package: &#39;MASS&#39; ## The following object is masked from &#39;package:dplyr&#39;: ## ## select library(scales) # to access break formatting functions # x and y axis are transformed and formatted p2 &lt;- ggplot(Animals, aes(x = body, y = brain)) + geom_point() + scale_x_log10(breaks = trans_breaks(&quot;log10&quot;, function(x) 10^x), labels = trans_format(&quot;log10&quot;, math_format(10^.x))) + scale_y_log10(breaks = trans_breaks(&quot;log10&quot;, function(x) 10^x), labels = trans_format(&quot;log10&quot;, math_format(10^.x))) + theme_bw() # log-log plot without log tick marks p2 # Show log tick marks p2 + annotation_logticks() 设置显示的位置： # Log ticks on left and right p2 + annotation_logticks(sides=&quot;lr&quot;) # All sides p2+annotation_logticks(sides=&quot;trbl&quot;) 使用函数scale_x_date()和scale_y_date()实现日期轴格式化： df &lt;- data.frame( date = seq(Sys.Date(), len=100, by=&quot;1 day&quot;)[sample(100, 50)], price = runif(50) ) df &lt;- df[order(df$date), ] # Plot with date dp &lt;- ggplot(data=df, aes(x=date, y=price)) + geom_line() dp library(scales) # Format : month/day dp + scale_x_date(labels = date_format(&quot;%m/%d&quot;)) + theme(axis.text.x = element_text(angle=45)) # Format : Week dp + scale_x_date(labels = date_format(&quot;%W&quot;)) # Months only dp + scale_x_date(breaks = date_breaks(&quot;months&quot;), labels = date_format(&quot;%b&quot;)) 设置日期轴范围： # Plot with dates dp &lt;- ggplot(data=economics, aes(x=date, y=psavert)) + geom_line() dp # Axis limits c(min, max) min &lt;- as.Date(&quot;2002-1-1&quot;) max &lt;- max(economics$date) dp+ scale_x_date(limits = c(min, max)) ## Warning: Removed 414 rows containing missing values or values outside the scale range ## (`geom_line()`). 还可以阅读函数 scale_x_datetime()和scale_y_datetime()的说明进一步学习。 1.3 地理空间包的退役 参加中山大学传染病预测预警建模培训班，听赖颖斯教授讲解传染病的时空预测模型构建时，用到了很多地理空间相关的R软件包，安装时发现很多包已经无法下载，检索发现R-spatial相关的rgdal，rgeos和maptools包都在2023年退役了，因为这些软件包的开发者Roger Bivand已经退休，不过在历史版本的R包资源中还是可以找到并下载这些软件包的，不知道未来会有哪些包代替它们。 "],["usage.html", "A 中文图书Bookdown模板的基本用法 A.1 安装设置 A.2 编写自己的内容 A.3 转换", " A 中文图书Bookdown模板的基本用法 A.1 安装设置 使用RStudio软件完成编辑和转换功能。 在RStudio中，安装bookdown等必要的扩展包。 本模板在安装之前是一个打包的zip文件， 在适当位置解压（例如，在C:/myproj下）， 得到MathJax, Books/Cbook, Books/Carticle等子目录。 本模板在Books/Cbook中。 为了利用模板制作自己的中文书， 将Books/Cbook制作一个副本， 改成适当的子目录名，如Books/Mybook。 打开RStudio软件， 选选单“File - New Project - Existing Directory”， 选中Books/Mybook子目录，确定。 这样生成一本书对应的R project（项目）。 为了将模板内容替换成自己的内容， 可以删除文件0101-usage.Rmd， 然后将1001-chapter01.Rmd制作几份副本， 如1001-chapter01.Rmd, 2012-chapter02.Rmd， 3012-chapter03.Rmd。 各章的次序将按照前面的数值的次序排列。 将每个.Rmd文件内的{#chapter01}, {#chapter02-sec01}修改能够反映章节内容的标签文本。 所有的标签都不允许重复。 参见本模板中的0101-usage.Rmd文件。 后面的§A.3.1 和§A.3.2 给出了将当前的书转换为网页和PDF的命令， 复制粘贴这些命令到RStudio命令行可以进行转换。 A.2 编写自己的内容 A.2.1 文档结构 除了index.Rmd以外， 每个.Rmd文件是书的一章。 每章的第一行是用一个井号（#）引入的章标题。 节标题用两个井号开始， 小节标题用三个井号开始。 标题后面都有大括号内以井号开头的标签， 标签仅用英文大小写字母和减号。 A.2.2 图形自动编号 用R代码段生成的图形， 只要具有代码段标签， 且提供代码段选项fig.cap=\"图形的说明文字\"， 就可以对图形自动编号， 并且可以用如\\@ref(fig:label)的格式引用图形。 如： plot(1:10, main=&quot;程序生成的测试图形&quot;) 图A.1: 图形说明文字 引用如：参见图A.1。 引用中的fig:是必须的。 在通过LaTeX转换的PDF结果中， 这样图形是浮动的。 A.2.3 表格自动编号 用R代码knitr::kable()生成的表格， 只要具有代码段标签， 并且在knitr::kable()调用时加选项caption=\"表格的说明文字\"， 就可以对表格自动编号， 并且可以用如\\@ref(tab:label)的格式引用表格。 如： d &lt;- data.frame(&quot;自变量&quot;=1:10, &quot;因变量&quot;=(1:10)^2) knitr::kable(d, caption=&quot;表格说明文字&quot;) 表A.1: 表格说明文字 自变量 因变量 1 1 2 4 3 9 4 16 5 25 6 36 7 49 8 64 9 81 10 100 引用如：参见表A.1。 引用中的tab:是必须的。 在通过LaTeX转换的PDF结果中， 这样的表格是浮动的。 A.2.4 数学公式编号 不需要编号的公式， 仍可以按照一般的Rmd文件中公式的做法。 需要编号的公式， 直接写在\\begin{align}和\\end{align}之间， 不需要编号的行在末尾用\\nonumber标注。 需要编号的行用(\\#eq:mylabel)添加自定义标签， 如 \\[\\begin{align} \\Sigma =&amp; (\\sigma_{ij})_{n\\times n} \\nonumber \\\\ =&amp; E[(\\boldsymbol{X} - \\boldsymbol{\\mu}) (\\boldsymbol{X} - \\boldsymbol{\\mu})^T ] \\tag{A.1} \\end{align}\\] 引用如：协方差定义见(A.1)。 A.2.5 文献引用与文献列表 将所有文献用bib格式保存为一个.bib文献库， 如模板中的样例文件mybib.bib。 可以用JabRef软件来管理这样的文献库， 许多其它软件都可以输出这样格式的文件库。 为了引用某一本书， 用如：参见(Wichmann and Hill 1982)。 被引用的文献将出现在一章末尾以及全书的末尾， 对PDF输出则仅出现在全书末尾。 A.3 转换 A.3.1 转换为网页 用如下命令将整本书转换成一个每章为一个页面的网站， 称为gitbook格式： bookdown::render_book(&quot;index.Rmd&quot;, output_format=&quot;bookdown::gitbook&quot;, encoding=&quot;UTF-8&quot;) 为查看结果， 在_book子目录中双击其中的index.html文件， 就可以在网络浏览器中查看转换的结果。 重新编译后应该点击“刷新”图标。 在章节和内容较多时， 通常不希望每次小修改之后重新编译整本书， 这时类似如下的命令可以仅编译一章， 可以节省时间， 缺点是导航目录会变得不准确。 命令如： bookdown::preview_chapter(&quot;1001-chapter01.Rmd&quot;, output_format=&quot;bookdown::gitbook&quot;, encoding=&quot;UTF-8&quot;) 单章的网页可以通过网络浏览器中的“打印”功能， 选择一个打印到PDF的打印机， 可以将单章转换成PDF格式。 A.3.2 生成PDF 如果想将R Markdown文件借助于LaTeX格式转换为PDF， 需要在系统中安装一个TeX编译器。 现在的rmarkdown包要求使用tinytex扩展包以及配套的TinyTeX软件包， 好像不再支持使用本机原有的LaTex编译系统， 如果不安装tinytex，编译为PDF格式时会出错。 TinyTeX优点是直接用R命令就可以安装， 更新也由R自动进行，不需要用户干预。 但是，安装时需要从国外网站下载许多文件， 有因为网络不畅通而安装失败的危险。 为了安装R的tinytex扩展包和单独的TinyTeX编译软件，应运行： install.packages(&#39;tinytex&#39;) tinytex::install_tinytex() 安装过程需要从国外的服务器下载许多文件， 在国内的网络环境下有可能因为网络超时而失败。 如果安装成功， TinyTeX软件包在MS Windows系统中一般会安装在 C:\\Users\\用户名\\AppData\\Roaming\\MikTex目录中， 其中“用户名”应替换成系统当前用户名。 如果需要删除TinyTeX软件包， 只要直接删除那个子目录就可以。 为了判断TinyTeX是否安装成功， 在RStudio中运行 tinytex::is_tinytex() 结果应为TRUE, 出错或者结果为FALSE都说明安装不成功。 在编译pdf_book时，可能会需要联网下载LaTeX所需的格式文件。 Bookdown借助操作系统中安装的LaTeX编译软件TinyTeX将整本书转换成一个PDF文件， 这需要用户对LaTeX有一定的了解， 否则一旦出错， 就完全不知道如何解决。 用户如果需要进行LaTeX定制， 可修改模板中的preamble.tex文件。 转换为PDF的命令如下： bookdown::render_book(&quot;index.Rmd&quot;, output_format=&quot;bookdown::pdf_book&quot;, encoding=&quot;UTF-8&quot;) 在_book子目录中找到CBook.pdf文件， 这是转换的结果。 CBook.tex是作为中间结果的LaTeX文件， 如果出错可以从这里查找错误原因。 转换PDF对于内容多的书比较耗时， 不要过于频繁地转换PDF， 在修改书的内容时， 多用bookdown::preview_chapter和转换为gitbook的办法检验结果。 定期地进行转换PDF的测试。 每增加一章后都应该试着转换成PDF看有没有错误。 A.3.3 上传到网站 如果书里面没有数学公式， 则上传到网站就只要将_book子目录整个地用ftp软件传送到自己的网站主目录下的某个子目录即可。 但是，为了支持数学公式，就需要进行如下的目录结构设置： 设自己的网站服务器目录为/home/abc， 将MathJax目录上传到这个目录中。 在/home/abc中建立新目录Books/Mybook。 将_book子目录上传到/home/abc/Books/Mybook中。 这时网站链接可能类似于http://dept.univ.edu.cn/~abc/Books/Mybook/_book/index.html, 具体链接地址依赖于服务器名称与主页所在的主目录名称。 如果有多本书， MathJax仅需要上传一次。 因为MathJax有三万多个文件， 所以上传MathJax会花费很长时间。 References "],["causal.html", "B 格兰格因果性 B.1 介绍 B.2 格兰格因果性的定义", " B 格兰格因果性 B.1 介绍 考虑两个时间序列之间的因果性。 这里的因果性指的是时间顺序上的关系， 如果\\(X_{t-1}, X_{t-2}, \\dots\\)对\\(Y_t\\)有作用， 而\\(Y_{t-1}, Y_{t-2}, \\dots\\)对\\(X_t\\)没有作用， 则称\\(\\{X_t \\}\\)是\\(\\{ Y_t \\}\\)的格兰格原因， 而\\(\\{ Y_t \\}\\)不是\\(\\{ X_t \\}\\)的格兰格原因。 如果\\(X_{t-1}, X_{t-2}, \\dots\\)对\\(Y_t\\)有作用， \\(Y_{t-1}, Y_{t-2}, \\dots\\)对\\(X_t\\)也有作用， 则在没有进一步信息的情况下无法确定两个时间序列的因果性关系。 注意这种因果性与采样频率有关系， 在日数据或者月度数据中能发现的领先——滞后性质的因果关系， 到年度数据可能就以及混杂在以前变成同步的关系了。 B.2 格兰格因果性的定义 设\\(\\{ \\xi_t \\}\\)为一个时间序列， \\(\\{ \\boldsymbol{\\eta}_t \\}\\)为向量时间序列， 记 \\[\\begin{aligned} \\bar{\\boldsymbol{\\eta}}_t =&amp; \\{ \\boldsymbol{\\eta}_{t-1}, \\boldsymbol{\\eta}_{t-2}, \\dots \\} \\end{aligned}\\] 记 \\(\\text{Pred}(\\xi_t | \\bar{\\boldsymbol{\\eta}}_t)\\)为基于 \\(\\boldsymbol{\\eta}_{t-1}, \\boldsymbol{\\eta}_{t-2}, \\dots\\) 对\\(\\xi_t\\)作的最小均方误差无偏预报， 其解为条件数学期望\\(E(\\xi_t | \\boldsymbol{\\eta}_{t-1}, \\boldsymbol{\\eta}_{t-2}, \\dots)\\)， 在一定条件下可以等于\\(\\xi_t\\)在\\(\\boldsymbol{\\eta}_{t-1}, \\boldsymbol{\\eta}_{t-2}, \\dots\\)张成的线性Hilbert空间的投影 （比如，\\((\\xi_t, \\boldsymbol{\\eta}_t)\\)为平稳正态多元时间序列）， 即最优线性预测。 直观理解成基于过去的\\(\\{\\boldsymbol{\\eta}_{t-1}, \\boldsymbol{\\eta}_{t-2}, \\dots \\}\\)的信息对当前的\\(\\xi_t\\)作的最优预测。 令一步预测误差为 \\[ \\varepsilon(\\xi_t | \\bar{\\boldsymbol{\\eta}}_t) = \\xi_t - \\text{Pred}(\\xi_t | \\bar{\\boldsymbol{\\eta}}_t) \\] 令一步预测误差方差，或者均方误差， 为 \\[ \\sigma^2(\\xi_t | \\bar{\\boldsymbol{\\eta}}_t) = \\text{Var}(\\varepsilon_t(\\xi_t | \\bar{\\boldsymbol{\\eta}}_t) ) = E \\left[ \\xi_t - \\text{Pred}(\\xi_t | \\bar{\\boldsymbol{\\eta}}_t) \\right]^2 \\] 考虑两个时间序列\\(\\{ X_t \\}\\)和\\(\\{ Y_t \\}\\)， \\(\\{(X_t, Y_t) \\}\\)宽平稳或严平稳。 如果 \\[ \\sigma^2(Y_t | \\bar Y_t, \\bar X_t) &lt; \\sigma^2(Y_t | \\bar Y_t) \\] 则称\\(\\{ X_t \\}\\)是\\(\\{ Y_t \\}\\)的格兰格原因， 记作\\(X_t \\Rightarrow Y_t\\)。 这不排除\\(\\{ Y_t \\}\\)也可以是\\(\\{ X_t \\}\\)的格兰格原因。 如果\\(X_t \\Rightarrow Y_t\\)，而且\\(Y_t \\Rightarrow X_t\\)， 则称互相有反馈关系， 记作\\(X_t \\Leftrightarrow Y_t\\)。 如果 \\[ \\sigma^2(Y_t | \\bar Y_t, X_t, \\bar X_t) &lt; \\sigma^2(Y_t | \\bar Y_t, \\bar X_t) \\] 即除了过去的信息， 增加同时刻的\\(X_t\\)信息后对\\(Y_t\\)预测有改进， 则称\\(\\{X_t \\}\\)对\\(\\{Y_t \\}\\)有瞬时因果性。 这时\\(\\{Y_t \\}\\)对\\(\\{X_t \\}\\)也有瞬时因果性。 如果\\(X_t \\Rightarrow Y_t\\)， 则存在最小的正整数\\(m\\)， 使得 \\[ \\sigma^2(Y_t | \\bar Y_t, X_{t-m}, X_{t-m-1}, \\dots) &lt; \\sigma^2(Y_t | \\bar Y_t, X_{t-m-1}, X_{t-m-2}, \\dots) \\] 称\\(m\\)为因果性滞后值(causality lag)。 如果\\(m&gt;1\\)， 这意味着在已有\\(Y_{t-1}, Y_{t-2}, \\dots\\)和\\(X_{t-m}, X_{t-m-1}, \\dots\\)的条件下， 增加\\(X_{t-1}\\), , \\(X_{t-m+1}\\)不能改进对\\(Y_t\\)的预测。 例B.1 设\\(\\{ \\varepsilon_t, \\eta_t \\}\\)是相互独立的零均值白噪声列， \\(\\text{Var}(\\varepsilon_t)=1\\), \\(\\text{Var}(\\eta_t)=1\\), 考虑 \\[\\begin{aligned} Y_t =&amp; X_{t-1} + \\varepsilon_t \\\\ X_t =&amp; \\eta_t + 0.5 \\eta_{t-1} \\end{aligned}\\] 用\\(L(\\cdot|\\cdot)\\)表示最优线性预测，则 \\[\\begin{aligned} &amp; L(Y_t | \\bar Y_t, \\bar X_t) \\\\ =&amp; L(X_{t-1} | X_{t-1}, \\dots, Y_{t-1}, \\dots) + L(\\varepsilon_t | \\bar Y_t, \\bar X_t) \\\\ =&amp; X_{t-1} + 0 \\\\ =&amp; X_{t-1} \\\\ \\sigma(Y_t | \\bar Y_t, \\bar X_t) =&amp; \\text{Var}(\\varepsilon_t) = 1 \\end{aligned}\\] 而 \\[ Y_t = \\eta_{t-1} + 0.5\\eta_{t-2} + \\varepsilon_t \\] 有 \\[\\begin{aligned} \\gamma_Y(0) = 2.25, \\gamma_Y(1) = 0.5, \\gamma_Y(k) = 0, k \\geq 2 \\end{aligned}\\] 所以\\(\\{Y_t \\}\\)是一个MA(1)序列， 设其方程为 \\[ Y_t = \\zeta_t + b \\zeta_{t-1}, \\zeta_t \\sim \\text{WN}(0, \\sigma_\\zeta^2) \\] 可以解出 \\[\\begin{aligned} \\rho_Y(1) =&amp; \\frac{\\gamma_Y(1)}{\\gamma_Y(0)} = \\frac{2}{9} \\\\ b =&amp; \\frac{1 - \\sqrt{1 - 4 \\rho_Y^2(1)}}{2 \\rho_Y(1)} \\approx 0.2344 \\\\ \\sigma_\\zeta^2 =&amp; \\frac{\\gamma_Y(1)}{b} \\approx 2.1328 \\end{aligned}\\] 于是 \\[\\begin{aligned} \\sigma(Y_t | \\bar Y_t) =&amp; \\sigma_\\zeta^2 = 2.1328 \\end{aligned}\\] 所以 \\[\\begin{aligned} \\sigma(Y_t | \\bar Y_t, \\bar X_t) = 1 &lt; 2.1328 = \\sigma(Y_t | \\bar Y_t) \\end{aligned}\\] 即\\(X_t\\)是\\(Y_t\\)的格兰格原因。 反之， \\(X_t\\)是MA(1)序列， 有 \\[ \\eta_t = \\frac{1}{1 + 0.5 B} X_t = \\sum_{j=0}^\\infty (-0.5)^j X_{t-j} \\] 其中\\(B\\)是推移算子（滞后算子）。 于是 \\[\\begin{aligned} L(X_t | \\bar X_t) =&amp; L(\\eta_t | \\bar X_t) + 0.5 L(\\eta_{t-1} | \\bar X_t) \\\\ =&amp; 0.5 \\sum_{j=0}^\\infty (-0.5)^j X_{t-1-j} \\\\ =&amp; - \\sum_{j=1}^\\infty (-0.5)^j X_{t-j} \\\\ \\sigma(X_t | \\bar X_t) =&amp; \\text{Var}(X_t - L(X_t | \\bar X_t)) \\\\ =&amp; \\text{Var}(\\eta_t) = 1 \\end{aligned}\\] 而 \\[\\begin{aligned} L(X_t | \\bar X_t, \\bar Y_t) =&amp; L(\\eta_t | \\bar X_t, \\bar Y_t) + 0.5 L(\\eta_{t-1} | \\bar X_t, \\bar Y_t) \\\\ =&amp; 0 + 0.5 L(\\sum_{j=0}^\\infty (-0.5)^j X_{t-1-j} | \\bar X_t, \\bar Y_t) \\\\ =&amp; -\\sum_{j=1}^\\infty (-0.5)^j X_{t-j} \\\\ =&amp; L(X_t | \\bar X_t) \\end{aligned}\\] 所以\\(Y_t\\)不是\\(X_t\\)的格兰格原因。 考虑瞬时因果性。 \\[\\begin{aligned} L(Y_t | \\bar X_t, \\bar Y_t, X_t) =&amp; X_{t-1} + 0 (\\text{注意}\\varepsilon_t\\text{与}\\{X_s, \\forall s\\}\\text{不相关} \\\\ =&amp; L(Y_t | \\bar X_t, \\bar Y_t) \\end{aligned}\\] 所以\\(X_t\\)不是\\(Y_t\\)的瞬时格兰格原因。 ○○○○○ 例B.2 在例B.1中，如果模型改成 \\[\\begin{aligned} Y_t =&amp; X_{t} + \\varepsilon_t \\\\ X_t =&amp; \\eta_t + 0.5 \\eta_{t-1} \\end{aligned}\\] 有怎样的结果？ 这时 \\[ Y_t = \\varepsilon_t + \\eta_t + 0.5 \\eta_{t-1} \\] 仍有 \\[\\begin{aligned} \\gamma_Y(0) = 2.25, \\gamma_Y(1) = 0.5, \\gamma_Y(k) = 0, k \\geq 2 \\end{aligned}\\] 所以\\(Y_t\\)还服从MA(1)模型 \\[ Y_t = \\zeta_t + b \\zeta_{t-1}, b \\approx 0.2344, \\sigma^2_\\zeta \\approx 2.1328 \\] \\[\\begin{aligned} L(Y_t | \\bar Y_t, \\bar X_t) =&amp; L(X_t | \\bar Y_t, \\bar X_t) + 0 \\\\ =&amp; L(\\eta_t | \\bar Y_t, \\bar X_t) + 0.5 L(\\eta_{t-1} | \\bar Y_t, \\bar X_t) \\\\ =&amp; 0 + 0.5 L(\\sum_{j=0}^\\infty (-0.5)^j X_{t-1-j} | \\bar Y_t, \\bar X_t) \\\\ =&amp; - \\sum_{j=1}^\\infty (-0.5)^j X_{t-j} \\\\ =&amp; X_t - \\eta_t \\\\ \\sigma(Y_t | \\bar Y_t, \\bar X_t) =&amp; \\text{Var}(\\varepsilon_t + \\eta_t) = 2 \\end{aligned}\\] 而 \\[ \\sigma(Y_t | \\bar Y_t) = \\sigma^2_\\zeta \\approx 2.1328 &gt; \\sigma(Y_t | \\bar Y_t, \\bar X_t) = 2 \\] 所以\\(X_t\\)是\\(Y_t\\)的格兰格原因。 反之， \\[\\begin{aligned} L(X_t | \\bar X_t, \\bar Y_t) =&amp; - \\sum_{j=1}^\\infty (-0.5)^j X_{t-j} \\\\ =&amp; L(X_t | \\bar X_t) \\end{aligned}\\] 所以\\(Y_t\\)不是\\(X_t\\)的格兰格原因。 考虑瞬时因果性。 \\[\\begin{aligned} L(Y_t | \\bar X_t, \\bar Y_t, X_t) =&amp; X_{t} + 0 (\\text{注意}\\varepsilon_t\\text{与}\\{X_s, \\forall s\\}\\text{不相关} \\\\ =&amp; X_t \\\\ \\sigma(Y_t | \\bar X_t, \\bar Y_t, X_t) =&amp; \\text{Var}(\\varepsilon) \\\\ =&amp; 1 &lt; 2 = \\sigma(Y_t | \\bar X_t, \\bar Y_t) \\end{aligned}\\] 所以\\(X_t\\)是\\(Y_t\\)的瞬时格兰格原因。 \\[\\begin{aligned} [aaa] \\end{aligned}\\] "],["references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
